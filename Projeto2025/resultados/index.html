<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ranking</title>
    <link rel="stylesheet" href="style.css">
    <script src="script.js" defer></script>
</head>

<body>

    <div class="header">
        <div class="title">
            <img src="img/logo.png" alt="Logo">
        </div>
        <h1 class="tiulo"> FLAGQUEST </h1>
    </div>

    <div class="content">
        <div class="ranking">
        </div>


        <div class="tableContent">
            <table>
                <thead>
                    <caption>RANKING - TOP 20</caption>
                    <br>
                    <div class="user-position" id="user-position">
                    </div>
                    <tr>
                        <th>Nome</th>
                        <th>Pontuação</th>
                        <th>Tempo</th>
                    </tr>
                </thead>
                <tbody id="ranking-table-body">
                </tbody>
            </table>
        </div>
    </div>

    <script>
        function carregarRanking() {
            fetch('https://609a-200-206-76-106.ngrok-free.app/getRanking', {
                method: 'GET', 
                headers: {
                    'ngrok-skip-browser-warning': 'true', 
                    'Content-Type': 'application/json' 
                }
            })
             
                .then(res => res.json())
                .then(data => {
                    if (Array.isArray(data) && data.length > 0) {
                        data.sort((a, b) => b.score - a.score);

                        const rankingTableBody = document.getElementById('ranking-table-body');
                        rankingTableBody.innerHTML = ''; 

                        data.slice(0, 20).forEach(entry => {
                            const tr = document.createElement('tr');
                            tr.innerHTML = `
                                <td>${entry.name}</td>
                                <td>${entry.score} pontos</td>
                                <td>${entry.time} segundos </td>
                            `;
                            rankingTableBody.appendChild(tr);
                        });
                    } else {
                        console.error("Os dados do ranking estão em um formato inesperado.");
                    }
                })
                .catch(error => {
                    console.error('Erro ao buscar o ranking:', error);
                });
        }

        window.onload = function() {
            carregarRanking();
        };
    </script>
</body>
<script src="script.js"></script>
</html>
